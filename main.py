# main.py
import time
import tag_process  # å¯¼å…¥ç¬¬ä¸€ä¸ªè„šæœ¬
import llm_tag      # å¯¼å…¥ç¬¬äºŒä¸ªè„šæœ¬
import generate_report # å¯¼å…¥ç¬¬ä¸‰ä¸ªè„šæœ¬

def run_full_pipeline():
    """
    æŒ‰é¡ºåºæ‰§è¡Œæ•´ä¸ªæ•°æ®åˆ†ææµç¨‹ã€‚
    """
    start_time = time.time()
    
    print("=========================================")
    print("ğŸš€ å¼€å§‹æ‰§è¡Œå®Œæ•´æ•°æ®åˆ†ææµç¨‹...")
    print("=========================================\n")

    # --- æ­¥éª¤ 1: å…³é”®è¯åˆæ­¥æ‰“æ ‡ ---
    print("--- [æ­¥éª¤ 1/3] å¼€å§‹æ‰§è¡Œå…³é”®è¯åˆæ­¥æ‰“æ ‡... ---")
    try:
        tag_process.main()
        print("--- [æ­¥éª¤ 1/3] åˆæ­¥æ‰“æ ‡å®Œæˆï¼ ---\n")
    except Exception as e:
        print(f"âŒ æ­¥éª¤ 1 æ‰§è¡Œå¤±è´¥: {e}")
        return # å¦‚æœå¤±è´¥åˆ™ä¸­æ–­æµç¨‹

    # --- æ­¥éª¤ 2: LLM æ·±åº¦åˆ†æ ---
    print("--- [æ­¥éª¤ 2/3] å¼€å§‹æ‰§è¡Œ LLM æ·±åº¦åˆ†æ... ---")
    print("ï¼ˆæ­¤æ­¥éª¤è€—æ—¶è¾ƒé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…...ï¼‰")
    try:
        llm_tag.main()
        print("--- [æ­¥éª¤ 2/3] LLM æ·±åº¦åˆ†æå®Œæˆï¼ ---\n")
    except Exception as e:
        print(f"âŒ æ­¥éª¤ 2 æ‰§è¡Œå¤±è´¥: {e}")
        return

    # --- æ­¥éª¤ 3: ç”Ÿæˆæœ€ç»ˆåˆ†ææŠ¥å‘Š ---
    print("--- [æ­¥éª¤ 3/3] å¼€å§‹ç”Ÿæˆæœ€ç»ˆåˆ†ææŠ¥å‘Š... ---")
    try:
        generate_report.main()
        print("--- [æ­¥éª¤ 3/3] æœ€ç»ˆæŠ¥å‘Šç”Ÿæˆå®Œæˆï¼ ---\n")
    except Exception as e:
        print(f"âŒ æ­¥éª¤ 3 æ‰§è¡Œå¤±è´¥: {e}")
        return

    end_time = time.time()
    total_time = end_time - start_time
    
    print("=========================================")
    print(f"âœ… å…¨éƒ¨åˆ†ææµç¨‹æ‰§è¡Œå®Œæ¯•ï¼æ€»è€—æ—¶: {total_time:.2f} ç§’ã€‚")
    print("=========================================")


if __name__ == "__main__":
    run_full_pipeline()